<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Complete Sign-In - Sunrise Education Centre</title>
    <link rel="stylesheet" href="style.css" />
      <link rel="stylesheet" href="floating-navbar.css">
    <link rel="stylesheet" href="uiverse-components.css">
</head>
  <body class="login-bg">
    <nav class="navbar glassmorphic">
      <div class="container nav-content">
        <div class="nav-logo">
          <img src="attached_assets/image_1750584670920.png" alt="Logo">
        </div>
        <ul class="nav-links">
          <li><a href="/">Home</a></li>
        </ul>
      </div>
    </nav>
    <div class="login-container">
      <div class="login-card">
        <div class="login-logo">
          <img src="attached_assets/image_1750584670920.png" alt="Logo">
          <h2>Complete Your Sign-In</h2>
          <p style="margin:0; color:#6b7280;">Signed in with: <strong>{{ email }}</strong></p>
        </div>
        <form method="POST" class="login-form">
          <!-- Link to existing username section - only show if not already linked -->
          {% if not session.get('pending_link_username') %}
          <div id="linkExistingSection">
            <label style="font-weight:600;">Link to existing username (optional)</label>
            <input type="text" name="link_username" placeholder="Existing username to link (e.g., yash)" />
            <small style="color:#6b7280;">If you already have an account, enter your existing username to link this Google email.</small>
            <div style="height:10px;"></div>
          </div>
          {% endif %}
          
          <!-- Create new username section - only show if not linking to existing -->
          {% if not session.get('pending_link_username') %}
          <div id="createNewSection">
            <label style="font-weight:600;">Or create a new username</label>
            <input type="text" name="chosen_username" placeholder="Preferred username" value="{{ suggested_name }}" />
          </div>
          {% endif %}
          
          <!-- Role selection - always visible -->
          <label style="font-weight:600;">Select your role/class</label>
          <select name="class_id" id="roleSelect" required style="border-radius:20px; padding:0.7rem 1.1rem;">
            <option value="">Select a role...</option>
            {% for id, name in all_classes %}
              <option value="{{ id }}">{{ name|title }}</option>
            {% endfor %}
          </select>
          
          <!-- Admin code field - only visible when admin role is selected -->
          <div id="adminCodeSection" style="display: none;">
            <input type="text" name="admin_code" placeholder="Admin Code (required for admin role)" required />
            <small style="color:#6b7280;">Admin code is required to verify admin privileges.</small>
          </div>
          
          <button type="submit" class="btn btn-primary">Continue</button>
        </form>
        <div class="login-links">
          <a href="/auth">Back to Login</a>
        </div>
      </div>
    </div>
  
    <!-- Search Modal -->
    <div id="searchModal" class="modal" style="display: none; position: fixed; z-index: 10000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);">
        <div class="modal-content black-glass" style="margin: 10% auto; padding: 2rem; border-radius: 20px; width: 90%; max-width: 600px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h2 style="color: white; margin: 0;">üîç Search</h2>
                <button onclick="closeSearch()" style="background: none; border: none; color: #fff; font-size: 1.5rem; cursor: pointer;">‚úï</button>
            </div>
            <input type="text" id="searchInput" placeholder="Search courses, resources, or topics..." style="width: 100%; padding: 15px; border: none; border-radius: 10px; background: rgba(255,255,255,0.1); color: white; font-size: 1rem; margin-bottom: 1rem;">
            <div id="searchResults" style="max-height: 300px; overflow-y: auto;"></div>
        </div>
    </div>

    <!-- Notification Panel -->
    <div id="notification-panel" class="notification-panel black-glass" style="display: none; position: fixed; top: 100px; right: 20px; width: 350px; max-height: 500px; overflow-y: auto; z-index: 999; border-radius: 16px; padding: 1rem; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid rgba(255,255,255,0.2);">
            <h3 style="margin: 0; font-size: 1.2rem; color: white;">üîî Notifications</h3>
            <button onclick="toggleNotifications()" style="background: none; border: none; color: #fff; font-size: 1.2rem; cursor: pointer; padding: 0.2rem;">‚úï</button>
        </div>
        <div class="notification-list">
            <div class="notification-item" style="padding: 0.8rem; border-bottom: 1px solid rgba(255,255,255,0.1); margin-bottom: 0.5rem;">
                <div style="font-weight: 600; margin-bottom: 0.3rem; color: white;">üìö Latest Updates</div>
                <div style="font-size: 0.9rem; opacity: 0.8; color: rgba(255,255,255,0.8);">Check out new features and content</div>
            </div>
        </div>
    </div>

    <script src="navbar-functions.js"></script>
</body>
  <script src="attached_assets/theme.js"></script>
  <script src="script.js"></script>
  <script>
    // Show/hide admin code field based on role selection
    document.getElementById('roleSelect').addEventListener('change', function() {
      const selectedRole = this.options[this.selectedIndex].text.toLowerCase();
      const adminCodeSection = document.getElementById('adminCodeSection');
      
      if (selectedRole === 'admin') {
        adminCodeSection.style.display = 'block';
        adminCodeSection.querySelector('input[name="admin_code"]').required = true;
      } else {
        adminCodeSection.style.display = 'none';
        adminCodeSection.querySelector('input[name="admin_code"]').required = false;
      }
    });
  </script>
</html>

